const canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d"),startButton=document.getElementById("startButton"),restartButton=document.getElementById("restartButton"),rewardImage=document.getElementById("rewardImage"),hiddenWord=document.getElementById("hiddenWord"),box=20;let snake,direction,food,score,gameInterval;function initializeGame(){snake=[{x:10*box,y:10*box}],direction="RIGHT",food={x:Math.floor(Math.random()*20)*box,y:Math.floor(Math.random()*20)*box},score=0,document.getElementById("score").textContent=score,rewardImage.style.display="none",hiddenWord.style.display="none",clearInterval(gameInterval)}startButton.addEventListener("click",()=>{startButton.style.display="none",restartButton.style.display="inline-block",canvas.style.display="block",document.addEventListener("keydown",changeDirection),document.addEventListener("keydown",revealHiddenWord),initializeGame(),gameInterval=setInterval(draw,100)}),restartButton.addEventListener("click",()=>{initializeGame(),gameInterval=setInterval(draw,100)});function changeDirection(e){"ArrowUp"===e.key&&"DOWN"!==direction?direction="UP":"ArrowDown"===e.key&&"UP"!==direction?direction="DOWN":"ArrowLeft"===e.key&&"RIGHT"!==direction?direction="LEFT":"ArrowRight"===e.key&&"LEFT"!==direction&&(direction="RIGHT")}function revealHiddenWord(e){"T"!==e.key&&"t"!==e.key||fetch("fetch_reward.php").then(e=>e.text()).then(e=>{hiddenWord.textContent=e,hiddenWord.style.display="block"}).catch(e=>console.error("Error fetching reward:",e))}function draw(){ctx.fillStyle="lightgreen",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="red",ctx.fillRect(food.x,food.y,box,box),ctx.fillStyle="blue",snake.forEach(e=>{ctx.fillRect(e.x,e.y,box,box)});let e={x:snake[0].x,y:snake[0].y};"UP"===direction&&(e.y-=box),"DOWN"===direction&&(e.y+=box),"LEFT"===direction&&(e.x-=box),"RIGHT"===direction&&(e.x+=box),e.x===food.x&&e.y===food.y?(score++,document.getElementById("score").textContent=score,food={x:Math.floor(Math.random()*20)*box,y:Math.floor(Math.random()*20)*box}):snake.pop(),score>=20&&(rewardImage.style.display="block"),(e.x<0||e.x>=canvas.width||e.y<0||e.y>=canvas.height||snake.some(t=>t.x===e.x&&t.y===e.y))&&(alert("Game Over! Your score: "+score),restartButton.style.display="inline-block",clearInterval(gameInterval)),snake.unshift(e)}
